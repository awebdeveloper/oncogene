'use strict';var _createClass=function(){function a(b,d){for(var g,f=0;f<d.length;f++)g=d[f],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}return function(b,d,f){return d&&a(b.prototype,d),f&&a(b,f),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var Oncogene=function(){function a(b){_classCallCheck(this,a),this.checkOptions(b),this.handleOptions(b),this.root.classList.add(this.classes.common.root),this.nextStep()}return _createClass(a,[{key:'nextStep',value:function nextStep(){return this.nextStepInx>=this.steps.length?this.showResults():void this.renderStep(this.steps[this.nextStepInx++])}},{key:'renderStep',value:function renderStep(b){function f(n){var o=n.currentTarget.dataset.inx,p=b.variants[o].value;b.key&&this.setVal(b.key,p),b.callback&&(this.config=b.callback(this.config,p));var q=this.afterEachStep(this.config);this.isUndefined(q)||(this.config=q),this.nextStep()}var g=document.createDocumentFragment(),h=this.createNode(this.classes.common.hint),j=this.createNode(this.classes.variants.root),k=this.createNode(this.classes.common.progress),l=this.nextStepInx-1,m=this.steps.length;b.variants.forEach(function(n,o){var p=this.createNode(this.classes.variants.item),q=this.createNode(this.classes.variants.hint),r=this.createNode(this.classes.variants.code);q.innerHTML=n.hint||'',r.innerHTML=n.code||'',p.dataset.inx=o,p.appendChild(q),p.appendChild(r),p.addEventListener('click',f.bind(this)),j.appendChild(p)}.bind(this)),h.innerHTML=b.hint||'',k.innerHTML=this.stepsCounter(l,m),g.appendChild(h),g.appendChild(j),g.appendChild(k),this.clearRoot(),this.root.appendChild(g)}},{key:'showResults',value:function showResults(){this.renderResult()}},{key:'renderResult',value:function renderResult(){var b=this.createNode(this.classes.result.root),d=this.createNode(this.classes.result.hint),f=this.createNode(this.classes.result.config);b.appendChild(d),b.appendChild(f),d.innerHTML=this.result.hint||'',f.textContent=this.result.callback(this.config),this.clearRoot(),this.root.appendChild(b)}},{key:'createNode',value:function createNode(b){var d=document.createElement('div');return d.className=b,d}},{key:'clearRoot',value:function clearRoot(){for(;this.root.firstChild;)this.root.removeChild(this.root.firstChild)}},{key:'setVal',value:function setVal(b,d){for(var h,f=b.split('.'),g=this.config;1<f.length;){if(h=f.shift(),g.hasOwnProperty(h)||(g[h]={}),!this.isObject(g[h]))throw new Error('Part of path '+b+' is not an object');g=g[h]}g[f.shift()]=d}},{key:'checkOptions',value:function checkOptions(b){var d=this;if(!b)throw new Error('You should specify options');if(['selector','steps'].forEach(function(j){if(!b.hasOwnProperty(j))throw new Error('You should specify '+j)}),['result','classes'].forEach(function(j){if(!d.isUndefined(b[j])&&!d.isObject(b[j]))throw new Error('options.'+j+' should be an object')}),['afterEachStep','stepsCounter'].forEach(function(j){if(!d.isUndefined(b[j])&&!d.isFunction(b[j]))throw new Error('options.'+j+' should be a function')}),!(b.steps instanceof Array))throw new Error('Steps should be an array')}},{key:'isObject',value:function isObject(b){return b===Object(b)&&!this.isFunction(b)}},{key:'isUndefined',value:function isUndefined(b){return'undefined'==typeof b}},{key:'isFunction',value:function isFunction(b){return'function'==typeof b}},{key:'handleOptions',value:function handleOptions(b){var d={config:{},classes:{},afterEachStep:function afterEachStep(g){return g},stepsCounter:function stepsCounter(g,h){return g+1+' / '+h},resultCallback:function resultCallback(g){return JSON.stringify(g,0,4)}},f=b.classes||d.classes;if(this.root=document.querySelector(b.selector),this.steps=b.steps,this.config=b.config||d.config,this.afterEachStep=b.afterEachStep||d.afterEachStep,this.stepsCounter=b.stepsCounter||d.stepsCounter,this.result=Object.assign({callback:d.resultCallback},b.result),this.classes={common:Object.assign({root:'oncogene',hint:'oncogene__hint',progress:'oncogene__progress'},f.common),variants:Object.assign({root:'oncogene-variants',hint:'oncogene-variants__hint',item:'oncogene-variants__item',code:'oncogene-variants__code'},f.variants),result:Object.assign({root:'oncogene-result',hint:'oncogene-result__hint',config:'oncogene-result__config'},f.result)},this.nextStepInx=0,!this.root)throw new Error('Can\'t find element by selector')}}]),a}();